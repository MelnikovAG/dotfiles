# vim: set ts=2 sw=2 noet filetype=gitconfig:

[core]
	compression = 0
	autocrlf = input
	excludesfile = /Users/henrebotha/.gitignore_global
	ignorecase=false
	editor = vim -X
	; -X:           don't talk to X11 on startup
	; -R:           read only mode
	; -n:           don't use a swap file
	; -c:           run command on start, after autocmd/modeline
	; --not-a-term: don't show the stupid "reading from stdin" message
	pager = vim -X -R - -n -c 'set filetype=git nowrap noro'
[color]
	; Vim/Kakoune can syntax highlight just fine on their own, and don't understand
	; colour codes, so we disable the colouring when using a pager
	pager = false
[user]
	name = HenrÃ© Botha
	useConfigOnly = true ; force me to set email in repo local config
[diff]
	compactionheuristic = true
	mnemonicprefix = true ; replace a/b with (i)ndex/(c)ommit/(w)orking tree
	renames = copies ; detect file copies as a type of rename
[grep]
	lineNumber = true
	extendedRegexp = true
	fallbackToNoIndex = true
[alias]
	# Display all aliases :)
	aliases = ! git config --list | awk '/alias/{ print $1 }' | perl -pe 's/alias\\.//g' | perl -pe 's/=.+//g'

	# https://twitter.com/DotProto/status/991112367323824128
	orphan = ! git log --pretty=oneline --abbrev-commit --graph --decorate `git reflog | cut -d \" \" -f 1`

	# Hide files from git
	hidden = ! git ls-files -v . | grep ^S | awk '{ print $2 }'
	hide = update-index --skip-worktree
	unhide = update-index --no-skip-worktree
	unhide-all = ! cd $(git rev-parse --show-toplevel || echo ".") && git hidden | xargs git unhide

	# # Alternative to git status - also shows hidden files! Currently broken...
	# s = ! sh -c 'git status $1' - && [ '$git hidden | wc -l' != '0' ] && echo '\n  Hidden files present!'

	hist = log --pretty=format:\"%h %ad | %s%d [%an]\" --graph --date=short

	# Safer alternative to --force
	pf = push --force-with-lease

	# Short aliases for simple commands, taken from the oh-my-zsh git plugin
	a = add
	apa = add --patch
	b = branch
	ba = branch -a
	c = commit
	cmsg = commit -m
	co = checkout
	dca = diff --cached
	dcaw = diff --cached --word-diff
	dcac = diff --cached --word-diff-regex=.
	dw = diff --word-diff
	dc = diff --word-diff-regex=.
	fa = fetch --all --prune
	l = log
	lo = log --oneline --decorate
	lg = -c core.pager='less -R' -c color.pager=true log --oneline --decorate --graph
	lga = -c core.pager='less -R' -c color.pager=true log --oneline --decorate --graph --all
	lgb = -c core.pager='less -R' -c color.pager=true log --oneline --decorate --graph --branches
	r = remote
	ra = remote add
	rbm = ! "git rebase -i `git merge-base HEAD master`"
	rmv = remote rename
	rrm = remote remove
	rv = remote -v
	st = status
	sdw = show --word-diff
	sdc = show --word-diff-regex=.

	wip = ! "f() { git add -A; git rm $(git ls-files --deleted) 2> /dev/null; git commit --no-verify -m '--wip-- [skip ci]'; }; f"
	unwip = ! "f() { git log -n 1 | grep -q -c \"\\-\\-wip\\-\\-\" && git reset HEAD~1; }; f"
	wips = ! git branch -v --no-abbrev | grep '\\-\\-wip\\-\\-'

	email = config --local user.email
[push]
	default = current
